function testThenDo(e){}function testThenDoAsync(e){}function getSrd(e){}(function(e){function t(){}t.getDirectoryName=function(e){for(var t=e.length-1;t>-1;){if("/"==e[t]||"\\"==e[t])return e.substring(0,t);t--}return""},t.getFileName=function(e){for(var t=e.length-1;t>-1;){if("/"==e[t]||"\\"==e[t])return e.substring(t+1);t--}return e},t.getFileNameWithoutExtension=function(e){for(var t=e.length-1,n=-1;t>-1;){if("."==e[t]&&-1==n)n=t;else if("/"==e[t]||"\\"==e[t])return-1==n?e.substring(t+1):e.substring(t+1,n);t--}return-1!=n?e.substring(0,n):e},t.getExtension=function(e){for(var t=e.length-1;t>-1;){if("."==e[t])return e.substring(t);if("/"==e[t]||"\\"==e[t])return"";t--}return e},t.changeExtension=function(e,t){for(var n=e.length-1;n>-1;){if("."==e[n])return e.substring(0,n)+t;if("/"==e[n]||"\\"==e[n])return e+t;n--}return e},e.Path=t})(this),function(e,t){function n(){}function s(e,t){if(0==e.global)throw"reg must global.";e.lastIndex=0;for(var n,s=[];null!==(n=e.exec(t));)s.push(n);return e.lastIndex=0,s}n.prototype.main=function(e,t){var n=s(t,e),r=[];if(0==n.length)r.push({w:e});else{if(n[0].index>0){var i=e.substr(0,n[0].index);r.push({w:i})}var a=n.length;n.forEach(function(t,s){r.push({w:t[0],exec:t});var i=s==a-1,o=t[0].length,c=i?e.substr(t.index+o,e.length-t.index-o):e.substr(t.index+o,n[s+1].index-t.index-o);0!=c.length&&r.push({w:c})})}return r},e.exports={SplitStringByRegex:n,matchGlobalWithCapture:s}}(this),function(e){function t(e){e=null!=e&&e;var t=new Date;this.log=function(n,s){if(0!=e){s=null==s||s;var r=new Date,i=r-t;console.log(n+" "+i+" ms."),s&&(t=r)}}}e.TestTime=t}(this),function(e){function t(e,t){function n(){return null!=t?t:"function"==typeof e?"assert "+e.toString():"assert fail."}if("function"==typeof e){if(0==e())throw Error(n())}else if("boolean"==typeof e&&0==e)throw Error(n())}e.assert=t}(this);var Ijnjs=(()=>{function e(e){}function t(e){}function n(e){}function s(){this.libs={}}function r(){this.caches={}}function i(){this.data=new r,this.getStr=function(e){return this.data.caches[e].str},this.setStr=function(e,t){null==this.data.caches[e]&&(this.data.caches[e]={}),this.data.caches[e].str=t},this.loadAsync=function(e){return this.data.loadFileCachesAsync(e)}}function a(){this.data=new r,this.generateJsDoc=function(e){var t=e.map(e=>"'"+e.na+"'").join("|");console.log(t)},this.setStr=function(e,t){null==this.data.caches[e]&&(this.data.caches[e]={}),this.data.caches[e].str=t},this.getStr=function(e){return this.data.caches[e].str}}function o(e,t){}function c(){}function l(){}return s.s=new s,r.prototype.loadFileCachesAsync=function(e){},i.s=new i,a.prototype.loadAsync=function(e){function t(e){function t(e){for(var t=e.length,n=t-1;n>=0;n--){if("/"==e[n])return;if("."==e[n])return e.substr(n+1)}}function s(){var e=n("ijnjs"),t=e.substring(0,e.lastIndexOf("/")+1),s=t.replace(location.origin,"");return s}var r=[],i=function(e,t){for(var n of e)if("string"==typeof n)r.push({na:t+n});else{var s=""==t?n.dir+"/":t+n.dir+"/";i(n.children,s)}};i(e,"");var a=s();for(var o of r){var c=t(o.na);o.url=null==c?a+o.na+".js":a+o.na}return r}var r=s.s.libs.$,i=(s.s.libs.Enumerable,t(e)),a=this;return Promise.all(i.map(e=>new Promise((t,n)=>{r.ajax({url:e.url,dataType:"text",complete:()=>t(e),success:t=>{a.setStr(e.na,t)}})})))},a.s=new a,c.prototype.main=function(e,t){},l.prototype.Libs=s,l.prototype.FileCache=r,l.prototype.testThenDo=e,l.prototype.testThenDoAsync=t,l.prototype.getHrefFromDocumentScripts=n,l.prototype.matchGlobalWithCapture=o,l.prototype.SplitStringByRegex=c,new l})();(function(root){function Libs(){this.libs={}}function FileCache(){this.caches={},this.clear=(()=>this.caches={})}function FileCache3rd(){this.data=new FileCache,this.getStr=function(e){return null==this.data.caches[e]&&(this.data.caches[e]={}),this.data.caches[e].str},this.setStr=function(e,t){null==this.data.caches[e]&&(this.data.caches[e]={}),this.data.caches[e].str=t},this.loadAsync=function(e){var t=Ijnjs.Libs.s.libs.$,n=getSrd("ijnjs"),s=e.filter(e=>"jquery"!=e.na).map(e=>{var s=/https?:\/\//i.test(e.url);return 0==s&&(e.url=n+e.url),new Promise(n=>{t.ajax({url:e.url,dataType:"text",complete:()=>{n()},success:t=>{this.data.caches[e.na]={str:t}}})})});return Promise.all(s)}}function FileCacheIjnjs(){this.data=new FileCache,this.list=[],this.generateJsDoc=function(e){var t=e.map(e=>"'"+e.na+"'").join("|");console.log(t)},this.setStr=function(e,t){null==this.data.caches[e]&&(this.data.caches[e]={}),this.data.caches[e].str=t},this.getStr=function(e){return this.data.caches[e].str},this.loadAsync=function(e){function t(e){function t(e){for(var t=e.length,n=t-1;n>=0;n--){if("/"==e[n])return;if("."==e[n])return e.substr(n+1)}}var n=[],s=function(e,t){for(var r of e)if("string"==typeof r)n.push({na:t+r});else{var i=""==t?r.dir+"/":t+r.dir+"/";s(r.children,i)}};s(e,"");var r=getSrd("ijnjs");for(var i of n){var a=t(i.na);i.url=null==a?r+i.na+".js":r+i.na}return n}if(null==Libs.s.libs.$)throw new Error("assert $ aleary exist.");var n=Libs.s.libs.$,s=this,r=t(e);return s.list=r.map(e=>e.na),Promise.all(r.map(e=>new Promise((t,r)=>{n.ajax({url:e.url,dataType:"text",complete:()=>t(e),success:t=>{s.setStr(e.na,t)}})})))}}function Ijnjs(){this.name="Ijnjs"}function getJQueryAsync(){return new Promise((res,rej)=>{var r1=new XMLHttpRequest;r1.onerror=(e=>{rej(e)}),r1.onload=(a1=>{if(304==r1.status||r1.status>=200&&r1.status<300){FileCache3rd.s.setStr("jquery",r1.responseText),noRequireJs(()=>{eval(FileCache3rd.s.getStr("jquery"))});var r2={};r2.$=window.$,delete window.$,delete window.jQuery,res(r2)}else rej(new Error("status code "+r1.status+" "+r1.statusText))}),r1.open("get",thirdPartFileDescription[0].url,!0),r1.send()})}function processIjnjsFile(){var s=FileCacheIjnjs.s;for(var a1 of(Ijnjs.Path={aa:()=>{}},["Path","SplitStringByRegex","assert","TestTime","rem2Px"])){function f1(){eval(s.getStr(a1))}var tmp={};if(f1.call(tmp),null!=tmp.exports){var keys=Object.keys(tmp.exports);for(var k of keys)Ijnjs[k]=tmp.exports[k]}else{var k=Object.keys(tmp)[0];if(null!=Ijnjs[k]){var r1=Ijnjs[k],r2=tmp[k];if("object"==typeof r1){for(var k2 of Object.keys(r2))r1[k2]=r2[k2];for(var k2 of Object.keys(r2.prototype))r1.prototype[k2]=r2.prototype[k2]}else if("function"==typeof r1){for(var k2 of Object.keys(r2))r1[k2]=r2[k2];for(var k2 of Object.keys(r2.prototype))r1.prototype[k2]=r2.prototype[k2]}else Ijnjs[k]=r2}else Ijnjs[k]=tmp[k]}}}function releaseCacheFromIjnjsAsync(){return testThenDoAsync({cbTest:()=>null!=Ijnjs.Libs.s.libs.bootstrap,msg:"release ijnjs cache"}).then(()=>{FileCache3rd.s.data.clear(),FileCacheIjnjs.s.data.clear(),delete Ijnjs.FileCache3rd,delete Ijnjs.FileCacheIjnjs})}function exportToRootAndDefine(){root.Ijnjs=Ijnjs;var e="function"==typeof define&&define.amd;e&&define("Ijnjs",[],function(){return Ijnjs})}function getSrd(e){function t(e){function t(e){var t=e.length;for(let n=t-1;n>=0;n--)if("/"==e[n])return e.substr(n+1)}var n=new RegExp(e+"(?:.min)?.js$","i");for(var s of document.scripts)if(null!=s.src){var r=t(s.src);if(null!=r&&n.test(r))return s.src}}var n=t(e),s=n.substring(0,n.lastIndexOf("/")+1),r=s.replace(location.origin,"");return r}function process3rdFile(){function addLodash(){function aaa(){eval(FileCache3rd.s.getStr("lodash"))}aaa.call(window),Libs.s.libs._=window._,delete window._}function addBootstrapWhenReady(){var $=Libs.s.libs.$;$(()=>{noRequireJs(()=>{function aaa(){eval(FileCache3rd.s.getStr("bootstrap"))}$("<style>",{text:FileCache3rd.s.getStr("bootstrap-css")}).appendTo($("head")),aaa.call(window),Libs.s.libs.bootstrap=window.bootstrap})})}function addJQueryUiAndTouchNowAndCssWhenReady(){function aaa(){eval(FileCache3rd.s.getStr("jquery-ui")),eval(FileCache3rd.s.getStr("jquery-touch"))}var $=Libs.s.libs.$;window.jQuery=$,aaa.call(window),$(()=>{$("<style>",{text:FileCache3rd.s.getStr("jquery-ui-css")}).appendTo($("head"))}),delete window.jQuery}function addLinqJs(){function aaa(){eval(FileCache3rd.s.getStr("linq"))}aaa.call(Libs.s.libs)}noRequireJs(()=>{addLinqJs(),addJQueryUiAndTouchNowAndCssWhenReady(),addBootstrapWhenReady(),addLodash()})}function noRequireJs(e){function t(){if(null!=window.define)for(var e of["define","requirejs","require"])s[e]=window[e],window[e]=void 0}function n(){if(null!=s.define)for(var e of["define","requirejs","require"])window[e]=s[e],delete s[e]}var s={};t(),e(),n()}function testThenDoAsync(e){function t(){"function"==typeof e&&(cbTest=e,e={cbTest:cbTest,msg:cbTest.toString()})}if(t(),"object"!=typeof e)throw new Error("call testThen Do, args already use {}");return new Promise((t,n)=>{e.cbDo=(()=>t()),e.cbErr=(e=>t(e)),testThenDo(e)})}function testThenDo(e){function t(){s()?a():(c+=1,c>o?(console.log("wait limit max count. "+o),i(new Error("wait limit max count."+o))):(console.log("wait "+r),setTimeout(()=>{l()},n)))}if("object"!=typeof e)throw new Error("call testThen Do, args already use {}");var n=null==e.ms?333:e.ms,s=null==e.cbTest?()=>!0:e.cbTest,r=null==e.msg?"":e.msg,i=null==e.cbErr?()=>{}:e.cbErr,a=null==e.cbDo?()=>{}:e.cbDo,o=null==e.cntMax?50:e.cntMax,c=0,l=t;try{t()}catch(e){i(e)}}window.testThenDo=testThenDo,window.testThenDoAsync=testThenDoAsync,window.getSrd=getSrd;var thirdPartFileDescription=[{na:"jquery",url:"https://code.jquery.com/jquery-3.6.0.min.js"},{na:"linq",url:"https://unpkg.com/linq@3.2.4/linq.min.js"},{na:"jquery-ui",url:"https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"},{na:"jquery-ui-css",url:"https://code.jquery.com/ui/1.12.1/themes/blitzer/jquery-ui.css"},{na:"jquery-touch",url:"../jquery.ui.touch-punch.min.js"},{na:"bootstrap-css",url:"https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css"},{na:"bootstrap",url:"https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"},{na:"lodash",url:"https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"}],ijnjsFileDescript=["Path","SplitStringByRegex","assert","TestTime","rem2Px",{dir:"BookChapDialog",children:[]}];Libs.s=new Libs,FileCache3rd.s=new FileCache3rd,FileCacheIjnjs.s=new FileCacheIjnjs,Ijnjs.Libs=Libs,Ijnjs.FileCache=FileCache,Ijnjs.FileCache3rd=FileCache3rd,Ijnjs.FileCacheIjnjs=FileCacheIjnjs,getJQueryAsync().then(e=>{Libs.s.libs.$=e.$;var t=FileCache3rd.s.loadAsync(thirdPartFileDescription),n=FileCacheIjnjs.s.loadAsync(ijnjsFileDescript);t.then(()=>{process3rdFile(),n.then(()=>{processIjnjsFile(),releaseCacheFromIjnjsAsync(),exportToRootAndDefine()})})})})(this);const{assert:assert}=require("./assert"),{rem2Px:rem2Px}=require("./rem2Px"),{TestTime:TestTime}=require("./TestTime")(function(root,undefined){function loadJsOrCssSync(e){/.js$/i.test(e)?(loadJsSync(e,!1),$("head").append($("<script>",{src:e}))):/.css$/i.test(e)?$("head").append($("<link>",{rel:"stylesheet",type:"text/css",href:e})):/.ico$/i.test(e)&&$("head").append($("<link>",{href:e,rel:"shortcut icon",type:"image/x-icon"}))}function loadCssSync(e){function t(e){var t=$("<style></style>");t.html(e),$("head").append(t)}$.ajax({url:e,dataType:"text",async:!1,cache:!0,success:t})}function loadJsSync(url,isCache){isCache=isCache!=undefined&&isCache,isCache?$.ajax({url:url,dataType:"text",async:!1,cache:!0,success:function(str){function aaa(){eval(str)}aaa.call(window)}}):$.ajax({url:url,dataType:"script",async:!1})}function exportModule(){"function"==typeof define&&define.amd?define("Ijnjs",[],function(){return Ijnjs}):"undefined"!=typeof module&&module.exports?module.exports=Ijnjs:root.Ijnjs=Ijnjs}function loadJsAsync(e){return Enumerable.from(e).select(generateOnePromise).toArray()}function generateOnePromise(a1){function fnPromise(resolve,reject){function success(strCode){function evalExec(){var fn=function(){eval(strCode)};fn.call(re)}function isOkay(){return 0!=Object.keys(re).length}function getResult(){return re[Object.keys(re)[0]]}var re={};evalExec(),Ijnjs.testThenDo(()=>{a1.cb(getResult()),resolve()},e=>isOkay())}$.ajax({url:srd+a1.path,dataType:"text",cache:!1,async:a1.async,success:success})}var srd=getServerRootDirectory();return new Promise(fnPromise)}function loadCss(e){var t=getServerRootDirectory();Enumerable.from(e).forEach(e=>{function n(e){var t=$("<style></style>");t.html(e),$("head").append(t)}$.ajax({url:t+e,dataType:"text",cache:!1,success:n})})}function waitThenSetReadyAsync(e){Promise.all(e).then(()=>{function e(){var e=Enumerable.from(Object.keys(Ijnjs)),t=Enumerable.from(["SplitStringByRegex","DialogBase","BibleVersionDialog"]).all(t=>e.contains(t));Ijnjs.assert(t)}e(),_isReady=!0})}function getLinqEnumerable(){return void 0===Enumerable&&"function"==typeof require?require("linq"):window.Enumerable}function getServerRootDirectory(){function e(){return 5500==location.port}function t(){return 4200==location.port}function n(){return"/NUI/ijnjs/"}function s(){return"/ijnjs/"}function r(){return"https://raw.githubusercontent.com/snowray712000/ijnjs/main/"}return e()?s():t()?r():n()}console.log((new Error).fileName),console.log(window.document.scripts);var Enumerable=getLinqEnumerable(),Ijnjs=function(){};Ijnjs.TestTime=TestTime;var dt=new TestTime(!1),_isReady=!1;Ijnjs.isReady=(()=>0!=_isReady),Ijnjs.testThenDo=testThenDo,Ijnjs.assert=assert,Ijnjs.rem2Px=rem2Px,Ijnjs.isLessMidWindow=(()=>$(window).width()<Ijnjs.rem2Px(36)),Ijnjs.getSrd=function(e){var t=Ijnjs.Path.getDirectoryName(location.pathname),n=0;for(let e=0;e<t.length;e++)"/"==t[e]&&n++;return 2==n?"../"+e+"/":1==n?e+"/":"NUII/"+e+"/"},Ijnjs.appendObjectTo=function(e,t){for(var n in e)t[n]=e[n]},generateOnePromise({path:"path.js",cb:function(e){Ijnjs.Path=e,dt.log("至 path ",!1),console.log(78)},async:!1}),Ijnjs.loadJsSync=loadJsSync,Ijnjs.loadCssSync=loadCssSync,Ijnjs.loadJsOrCssSync=loadJsOrCssSync,Ijnjs.loadJsInIIFEModel=function(path,isCache,isAsync){return new Promise((res,rej)=>{Ijnjs.testThenDo(()=>{function cb(strCode){var fn=function(){eval(strCode)},re={};fn.call(re),Ijnjs.testThenDo(()=>{res(re)},e=>0!=Object.keys(re).length)}var srd=Ijnjs.Path.getDirectoryName(location.pathname)+"/",settings={url:srd+path,dataType:"text",success:cb};isCache!=undefined&&(settings.cache=isCache),isAsync!=undefined&&(settings.async=isAsync),$.ajax(settings)},e=>Ijnjs.Path!=undefined)})};var csses=["ijn-dialog-base.css","bible-version-dialog-picker.css"];loadCss(csses);var deps=[{path:"SplitStringByRegex.js",cb:function(e){Ijnjs.SplitStringByRegex=e,dt.log("至 SplitStringByRegex ",!1)}},{path:"ijn-dialog-base.js",cb:function(e){Ijnjs.DialogBase=e,dt.log("至 DialogBase ",!1)}},{path:"bible-version-dialog-picker.js",cb:function(e){Ijnjs.BibleVersionDialog=e,dt.log("至 BibleVersionDialog ",!1)}}],ajaxs=loadJsAsync(deps);waitThenSetReadyAsync(ajaxs),exportModule()})(this);(function(e){function t(e){function t(){Ijnjs.testThenDo(()=>{n=parseFloat($("body").css("font-size"))},()=>0!=$("body").length,50)}var n;return null==n?(t(),16*e):n*e}e.rem2Px=t})(this);